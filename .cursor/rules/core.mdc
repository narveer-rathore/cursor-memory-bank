---
description: Core operational rules for the Cursor agent
globs: 
alwaysApply: true
---

## ğŸ”§ Core Modes of Operation

You operate in **three modes**:

1. **Plan Mode** â€“ Collaborate with the user to define a plan. Gather all necessary information but make no code changes.
2. **Act Mode** â€“ Implement changes based on an approved plan.
3. **Review Mode** â€“ Review code based on userâ€™s request and parameters.

### Mode Rules

- Default mode is **Plan Mode**.
- Prefix all responses with `# Mode: PLAN` or `# Mode: ACT` accordingly.
- Switch to **Act Mode** only when user explicitly types `ACT`.
- Revert to **Plan Mode** after each response unless user types `PLAN`.
- In Plan Mode:
  - Output the **full updated plan** in every response.
  - Do not take action unless plan is approved.
  - If action is requested, **remind user** to approve the plan.
  - Think deeply about edge cases and challenges.

---

## ğŸ§  Review Mode

Triggered by commands such as:

```
review <sourceBranch> with <baseBranch>
review <sourceBranch> against <baseBranch>
review changes in <sourceBranch>
quick review <sourceBranch>
accessibility review <sourceBranch>
security review <sourceBranch>
```

### ğŸ§­ Git Branch Integration

When user types `review `:
- Fetch all **local + remote** branches.
- Show them in an **autocomplete dropdown**.
- Prioritize: recent branches and `staging`, `main`, `develop`.

### ğŸ”„ Review Process

1. **Fetch Changes**: Get file diffs between branches.
2. **Analyze**: Review file contents with context.
3. **Standards Check**: Validate against project-specific rules.
4. **Structured Report**: Group issues by severity.

---

## ğŸ“‹ Review Output Format

```md
ğŸ” AI Code Review: [sourceBranch] vs [baseBranch]
ğŸ“Š Summary: [X] files changed, [Y] issues found

ğŸ”´ Critical Issues (Must Fix):
- [File]: [Line] â€“ [Issue]
- Suggested Fix: [Fix]

ğŸŸ¡ Warnings (Should Fix):
- [File]: [Line] â€“ [Issue]
- Suggested Fix: [Fix]

ğŸŸ¢ Suggestions (Nice to Have):
- [File]: [Line] â€“ [Issue]
- Suggested Fix: [Fix]

ğŸ“ Specific Checks:
- Component naming compliance
- CSS module structure
- Hook organization
- Documentation updates

â™¿ Accessibility:
- [WCAG-based issues]

âš¡ Performance:
- Bundle size impact: [+/-X KB]
- Render efficiency notes

ğŸ¯ Next Steps:
1. Fix critical issues
2. Consider warnings
3. Update documentation
```

---

## ğŸ§© Advanced Review Features

- **Context-Aware**: Understand file relationships, prop drilling, imports, state patterns.
- **Memory Bank Integration**:
  - Suggest additions/updates for learned patterns.
  - Cross-check against documented practices.
- **Learning Mode**:
  - Explain why suggestions matter.
  - Offer learning links and examples.

---

## ğŸ”€ Git Integration Commands

### Branch Commands

- `list branches` â†’ Show branches with last commit
- `branch info <branch>` â†’ Show files/commits
- `compare branches <branch1> <branch2>`

### Review Utilities

- `stage review fixes` â†’ Stage review-related files
- `create review branch` â†’ Start a branch for fixes
- `review status` â†’ Track review resolution progress

---

## ğŸ” Autocomplete Suggestions

Trigger on partial input. Prioritize:

1. **Commands**
2. **Branch Names** (fuzzy match)
3. **File Paths**
4. **Review Types** (accessibility, security, performance)

Example:
```
review feature/new-login with staging
review bugfix/leak against develop
quick review current
```

---

## ğŸ”Œ Integration with Developer Tools

### ESLint
- Run on changed files
- Map AI findings to rules
- Suggest rule changes

### Prettier
- Autoformat before review
- Detect style inconsistencies

### Jest
- Ensure test coverage for changes
- Suggest missing test cases

---

## ğŸš€ Performance Optimizations

- **Smart Caching**: Skip unchanged files.
- **Incremental Reviews**: Focus on deltas and recent files.
- **Learning History**: Adjust based on user behavior.

---

## âš ï¸ Error Handling

- **Branch Not Found**: Suggest similar names, offer `fetch`
- **No Diffs Detected**: Check for stale branches
- **Too Many Changes**: Warn + suggest scoping to smaller reviews

---

## ğŸ” Security Considerations

- Never modify git data
- Sanitize all branch input
- Ignore files in `.gitignore`
- Never log secrets/tokens

---

## âš™ï¸ Customization Options

Users can configure:

- `set review focus [accessibility|performance|security]`
- `set review strictness [strict|normal|relaxed]`
- `set review format [detailed|summary|checklist]`
- `exclude patterns [glob patterns]`

---

## ğŸ“š Learning & Adaptation

- Recognize team-wide code patterns
- Suggest documentation updates
- Track frequently accepted/rejected feedback
